{% extends "front/base.html" %}

{% block title %}
  Post Message
{% endblock %}

{% block head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='front/css/public_post.css') }}">
  <script src="{{ url_for('static', filename='js/wangEditor.min.js') }}"></script>
  <script src="{{ url_for('static', filename='front/js/public_post.js') }}"></script>
{% endblock %}

{% block body %}
  <h1 class="page-title">New Request</h1>
  <div class="form-container">
    <form action="" method="post">
      <div class="form-group">
        <label>Title</label>
        <input type="text" class="form-control" name="title">
      </div>
      <div class="form-group">
        <label>Category</label>
        <select name="board_id" class="form-control">
          {% for board in boards %}
            <option value="{{ board.id }}">{{ board.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="form-group">
        <label>Content</label>
        <div id="editor"></div>
        <input type="hidden" name="content" id="content">
      </div>
      <div class="form-group">
        <label>Credits</label>
        <input type="text" class="form-control" name="credit">
      </div>
      <hr/>
      <div class="form-group">
        <button class="btn btn-danger btn-block" id="submit-btn">Post</button>
      </div>
    </form>
  </div>

  <script>
    // Initialize the editor
    const E = window.wangEditor
    const editor = new E('#editor')
    const $content = document.getElementById('content')
    editor.config.onchange = function (html) {
      // Sync editor content to hidden input
      $content.value = html
    }
    editor.create()

    // Handle form submission
    document.querySelector('form').addEventListener('submit', function (e) {
      if ($content.value.trim() === '') {
        e.preventDefault()
        alert('Please enter some text in the content.')
      }
    })
  </script>
{% endblock %}
